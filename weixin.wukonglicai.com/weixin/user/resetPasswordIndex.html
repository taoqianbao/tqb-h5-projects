<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>修改登录密码</title>
	<link rel="stylesheet" href="https://m.p2p.com/css/reset.css" />
	<link rel="stylesheet" href="https://m.p2p.com/css/base.css" />
	<link rel="stylesheet" href="https://m.p2p.com/css/zhezhao.css" />
	<script type="text/javascript" src="https://m.p2p.com//javascript/jquery-1.7.2.min.js"></script>
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,initial-scale=1.0" />
	<meta content="yes" name="apple-mobile-web-app-capable" />
	<meta content="black" name="apple-mobile-web-app-status-bar-style" />
	<meta content="telephone=no" name="format-detection" />
</head>
<script type="text/javascript">
	var teg1=false;
	var teg2=false;
	var teg3=false;
	function trim(str){
	     return str.replace(/(^\s*)|(\s*$)/g,"");
	};
	function sub(){
		var newPassword = $("#newPassword").val();
		var oldPassword = $("#oldPassword").val();
		var reNewPassword = $("#reNewPassword").val();
		if(oldPassword==""||trim(oldPassword)==""){
			$("#messageTip").html("原密码不能为空");
			showHidden();
			return false;
		}
/* 		if(newPassword==""||trim(newPassword)==""||reNewPassword==""||trim(reNewPassword)==""){
			$("#messageTip").html("新密码或重复密码不能为空");
			showHidden();
			return false;
		} */
		/* if(newPassword!=reNewPassword){
			$("#messageTip").html("新密码两次输入不一致");
			showHidden();
			return false;
		}
		if(newPassword==oldPassword){
			$("#messageTip").html("新密码和旧密码不能一致");
			showHidden();
			return false;
		} */
					$.ajax({
		 				type:"post",
		 				url:"https://m.p2p.com/weixin/user/confrimReSetPwd.html",
		 				data:{"newPassword":newPassword,"oldPassword":oldPassword,"reNewPassword":reNewPassword},
		 				success:function(data){
		 				if(data.code=="success"){
		 					$("#zhezho").show();
							$("#zh").show();
							setTimeout(function () {$("#goLogin").submit()}, 300); 
		 					}else if(data.code=="0"){
		 						$("#messageTip").html("原密码输入错误");
								showHidden();
								$("#oldPassword").val()="";
								teg1 =  false;
								return teg1;	
		 					}else if(data.code=="1"){
		 						$("#messageTip").html("密码格式不正确，请输入6-16个英文字母、数字组合");
								showHidden();
								$("#newPassword").val()="";
			 					$("#reNewPassword").val()="";
			 					teg1 =  false;
			 					return teg1;
		 					}else if(data.code=="4"){
		 						$("#messageTip").html("两次输入的登录密码不相同，请重新输入");
								showHidden();
								$("#newPassword").val()="";
			 					$("#reNewPassword").val()="";
			 					teg1 =  false;
			 					return teg1;
		 					}else if(data.code=="5"){
		 						$("#messageTip").html("新密码和旧密码不能一致");
								showHidden();
								$("#newPassword").val()="";
			 					$("#reNewPassword").val()="";
			 					teg1 =  false;
			 					return teg1;
		 					}else if(data.code=="2"){
		 						$("#messageTip").html("登录密码不能与取现密码相同，请重新输入");
								showHidden();
								$("#newPassword").val()="";
			 					$("#reNewPassword").val()="";
			 					teg1 =  false;
			 					return teg1;
		 					}else if(data.code=="3"){
		 						$("#messageTip").html("新密码不能与原密码相同，请重新输入");
								showHidden();
								$("#newPassword").val()="";
			 					$("#reNewPassword").val()="";
			 					teg1 =  false;
			 					return teg1;
		 					}
		 				}
		 		});
		
		
	}
	
	function showHidden(){
		$("#zhezhao4").show();
		$("#showDiv4").show();
		$("#zhe4").show();
		teg1 =  false;	
	}
	
	function checkPassword(obj){
		var reg = /^[0-9a-zA-Z]{6,16}$/;
		if( !reg.test(obj)){
			$("#messageTip").html("密码格式不正确，请输入6-16个英文字母、数字组合");
			showHidden();
			 $("#newPassword").val()="";
			 $("#reNewPassword").val()="";
    		return false; 
		}else{
			return true;							
		}
	};
		
    function handleEnter (field, event) {
		var keyCode = event.keyCode ? event.keyCode : event.which ?
		event.which : event.charCode;
		if (keyCode == 13) {
			var i;
			for (i = 0; i < field.form.elements.length; i++)
			if (field == field.form.elements[i])
			break;
			i = (i + 1) % field.form.elements.length;
			field.form.elements[i].focus();
			return false;
		}
		else
		return true;
	}
	
	function messageTip2(){
			$("#zhezhao2").hide();
			$("#showDiv2").hide();
			$("#zhe2").hide();
			teg1=false;
			teg2=false;
			teg3=false;
	}
	function messageTip4(){
			$("#zhezhao4").hide();
			$("#showDiv4").hide();
			$("#zhe4").hide();
			teg1=false;
			teg2=false;
			teg3=false;			
	}
	function messageTip(){
			$("#zhezhao").hide();
			$("#showDiv").hide();
			$("#zhe").hide();
			teg1=false;
			teg2=false;
			teg3=false;			
	}
	function messageTip5(){
			$("#zhezhao5").hide();
			$("#showDiv5").hide();
			$("#zhe5").hide();
			teg1=false;
			teg2=false;
			teg3=false;			
	}	
</script>
<body>
<form action="https://m.p2p.com/weixin/loginPassword.html" method="post" id ="goLogin">
	<input type="hidden" name="phoneNumber" id="phoneNumber" value="15901604741">
</form>
	<div class = "box">
		<section class = "xiugai">
			<form id="form" action="" method="post">
				<div class = "asied">
					<div class = "aisde_odi">
						<input type="password" placeholder="原密码"  id = "oldPassword" name="oldPassword" />
					</div>
				</div>
				<aside class = "aisde">
					<div>
						<div class = "aisde_od">
							<input type="password" placeholder="设置密码"  id = "newPassword" name = "newPassword"  onkeypress="return handleEnter(this, event)"/>
						</div>
					</div>
					<div>
						<div class = "aisde_od">
							<input type="password" placeholder="重复密码"  id = "reNewPassword" name ="reNewPassword" onkeydown='return handleEnter(this, event)'/>
						</div>
					</div>
				</aside>
				<aside class = "xiugai_div">
					<input type="button" value = "确认" class = "login_btn" onclick="sub()" />
				</aside>
			</form>
			
		</section>
	</div>
	
	<section class = "zhezhao" id = "zhezhao3" ></section>
	<aside class = "showDiv" id = "showDiv3">
		<div class = "zhe" id = "zhe3">
		    <h1>提示</h1>
			<p>登录密码重置成功</p>
			<span><span id="second">3</span>秒后跳转到登录页面</span>
		</div>
	</aside>
	
	
	<section class = "zhezhao" id = "zhezhao4" ></section>
	<aside class = "showDiv" id = "showDiv4">
		<div class = "zhe" id = "zhe4">
		    <h1>提示</h1>
			<p id="messageTip">原密码输入错误</p>
			<span id = "bto4" onclick="messageTip4()">确定</span>
		</div>
	</aside>
	
	<div id = "zhezho" class = "zhezh">
		<div id = "zh" class = "zhc">
		<div>
			<img src="https://m.p2p.com/img/opdui.png" alt="">
		</div>
		<div>
			<p>密码修改成功</p>
		</div>
		</div>
	</div>
<!doctype html>
<meta charset="UTF-8">
<p style="position:absolute;right:2rem;bottom:6rem;font-size:10px;color:#dddddd">市场有风险，投资需谨慎</p>
					

</body>
</html>